# Epic 7 Retrospective: Text Analysis Tools

**Date:** 2026-02-14
**Facilitator:** Bob (Scrum Master)
**Epic Status:** Complete — 2/2 stories done

## Team Participants

- Bob (Scrum Master) — Facilitator
- Alice (Product Owner) — Product perspective
- Charlie (Senior Dev) — Technical leadership
- Dana (QA Engineer) — Quality perspective
- Elena (Junior Dev) — Fresh eyes perspective
- csrteam (Project Lead) — Overall direction

## Epic Summary & Metrics

**Delivery:**

- Stories completed: 2/2 (100%)
- Velocity: Both stories completed in single sessions each
- Scope changes: 0
- Production incidents: 0

**Quality:**

- Tests added: 45 new tests (26 diff + 19 regex)
- Total automated tests: 467 (422 at start → 467 at end)
- Code review findings: 9 across 2 stories (1H + 6M + 2L in 7-1, 0H + 3M in 7-2)
- Debug issues: 0 (clean implementations across both stories)
- Technical debt introduced: 1 LOW item (DiffChange type co-located in utils/ instead of types/)
- New dependency: 1 (`diff@8.0.3` — dynamically imported, code-split)

**Stories Delivered:**

| Story | Title | Debug Issues | Review Fixes | Files Created | Files Modified |
|-------|-------|-------------|-------------|---------------|----------------|
| 7-1 | Text Diff Checker | 0 | 6 (1H, 3M, 2L) | 4 | 8 |
| 7-2 | Regex Tester | 0 | 3 (0H, 3M) | 3 | 8 |

**FRs Delivered:**

- FR20: Text diff comparison — complete
- FR21: Regex testing with live highlighting — complete

**Tools Added:**

- Text Diff Checker (registry key: `text-diff-checker`, chunk: 5.70 kB)
- Regex Tester (registry key: `regex-tester`, chunk: 5.39 kB)
- Registry now has 13 tools (up from 11)
- New tool category created: Text

## Previous Retro Follow-Through (Epic 6)

| # | Action Item | Owner | Status | Notes |
|---|-------------|-------|--------|-------|
| 1 | Add whitespace-only input handling to story template checklist | Bob (SM) | ⏳ Partial | Text tools operate on raw text — whitespace-only IS valid input. Not a meaningful edge case for diff/regex. Applied where relevant (empty-input clearing). |
| 2 | Strengthen test assertion patterns — require specific matchers | Bob (SM) | ✅ Applied | All assertions use specific matchers (`toBe`, `toEqual`, `toContain`, `toHaveLength`). Zero `toBeTruthy` or bare `toThrow()` in Epic 7 tests. |
| 3 | Error message architecture compliance check | Bob (SM) | ⏳ Partial | 7-1: minimal error states by design (any text is valid diff input). 7-2: uses native `SyntaxError` messages from RegExp — appropriate for regex patterns where no single "valid example" exists. |
| 4 | Add E2E Common Gotchas to CONTRIBUTING.md | Amelia (Dev) | ❌ Not Addressed | **CARRIED 4TH EPIC** — first flagged Epic 4, carried through 5, 6, 7. Not embedded in any Epic 7 story. |
| 5 | Audit remaining tools for type="number" silent-drop | Amelia (Dev) | ❌ Not Addressed | **CARRIED 4TH EPIC** — first flagged Epic 4, carried through 5, 6, 7. Not embedded in any Epic 7 story. |

**Pattern confirmed for fifth consecutive epic:** Items not embedded in stories don't get done. Items 4 and 5 have now survived 4 retros without action. The Epic 6 retro explicitly stated "Items carried 3+ epics must be dropped or force-embedded." This agreement was itself not followed.

## What Went Well

- **Fifth consecutive clean epic** — Zero debug issues, zero scope creep, zero blockers across all 5 epics (3 through 7). This is now a stable pattern, not luck.
- **Domain foundation pattern continues to pay off** — Story 7-1 established the Text category, domain directory (`components/feature/text/`), barrel exports, and sidebar category order. Story 7-2 reused this foundation with zero setup friction. Same accelerator pattern seen in Epic 6.
- **Cross-story and cross-epic learning is mature** — Both stories reference "Previous Story Intelligence" sections. Story 7-2 explicitly learned from 7-1's async pattern to know it didn't need sessionRef (synchronous RegExp). Learnings from Epic 6 (whitespace handling, assertion quality) were applied.
- **Architectural pattern selection is getting stronger** — Story 7-1 correctly identified the async pattern (dynamic import of `diff` library → sessionRef needed) and story 7-2 correctly identified the synchronous pattern (native RegExp → no sessionRef). This shows mature pattern recognition.
- **Code review catching real issues before production** — 9 findings across 2 stories including 1 HIGH severity (hardcoded color tokens instead of theme tokens). Theme token compliance and accessibility attributes are consistently the top review findings.
- **Test growth** — 45 new tests bringing total to 467. Strong coverage for all utility functions.
- **Smart library decision for diff** — `diff` (jsdiff) v8+ chosen for Text Diff Checker: proven library, built-in TypeScript types, dynamically imported. Regex Tester correctly chose NO library — native RegExp is sufficient.
- **Side-by-side diff rendering** — The `computeSideBySideDiff` algorithm with `diffWords` inline character highlighting is a complex UI achievement executed cleanly. CSS grid with sticky headers, line numbers, and indicator bars.

## What Didn't Go Well

- **Accessibility attributes still caught in review, not built-in** — Story 7-1: missing `role="region" aria-label="Diff output"` on output container. Story 7-2: missing `aria-live="polite"` on output region. This has been a pattern across multiple epics — accessibility is reactive (caught in review) rather than proactive (built into the component from the start).
- **Theme token compliance violation** — Story 7-1 used hardcoded `bg-emerald-500/10`/`bg-red-500/10` instead of the project's `bg-success/10`/`bg-error/10` theme tokens. HIGH severity because it breaks theme consistency. This suggests that custom/complex rendering (like the diff grid) bypasses the muscle memory of using theme tokens.
- **Carried items now at 4 epics — systemic accountability failure** — E2E gotchas and type="number" audit have been carried across Epics 4, 5, 6, and 7. The Epic 6 retro explicitly created a team agreement: "Items carried 3+ epics must be dropped or force-embedded." The agreement itself was not followed. This is no longer a process gap — it's a systemic accountability failure.
- **Undisclosed file modifications** — Story 7-2 review caught that `src/pages/tool/index.tsx` was modified (formatting cleanup) but not listed in the story's File List. While minor, it indicates that file tracking in story records isn't airtight.

## Key Insights

1. **Accessibility must be a CHECKLIST ITEM, not a review catch** — Two consecutive stories with accessibility findings in review. The fix is simple: add "WCAG attributes verified (role, aria-label, aria-live)" as a required checklist item before marking a task complete.
2. **Theme token compliance needs enforcement for custom rendering** — Standard component patterns (using existing `FieldForm`, `CopyButton`, etc.) automatically use theme tokens. But custom rendering (diff grids, highlight spans) bypasses this and needs explicit attention.
3. **Cross-story learning is now a proven accelerator across 3 consecutive epics** — "Previous Story Intelligence" sections eliminated debug issues in Epics 5, 6, and 7. The pattern compounds: each story and each epic gets smoother.
4. **Synchronous vs. async pattern selection is a critical design decision** — Story 7-1 needed async (external library) while 7-2 was synchronous (native API). The team correctly identified which pattern to use in each case. This should be documented as a decision tree for future tools.
5. **Carried items have a hard limit — 3 epics** — After 4 epics of carrying E2E gotchas and type="number" audit, the only options are: (a) force-embed in Epic 8 Story 1, or (b) permanently drop. There is no option (c) "carry again."
6. **Code review findings are trending down** — Epic 6: 15 findings across 3 stories. Epic 7: 9 findings across 2 stories. Per-story average: 5.0 → 4.5. The severity is also trending down (2H in Epic 6, 1H in Epic 7).
7. **Generator tools (Epic 8) will introduce a NEW processing pattern** — Epic 7 tools were debounced live processors. Epic 8 tools (UUID, password, hash) use explicit "Generate" button clicks. This is a different processing trigger pattern per architecture.md.

## Action Items

### Process Improvements

| # | Action | Owner | Priority | Success Criteria |
|---|--------|-------|----------|-----------------|
| 1 | Add WCAG accessibility checklist to task completion criteria: `role`, `aria-label`, `aria-live`, keyboard navigation | Bob (SM) | HIGH | Zero accessibility findings in code review for Epic 8 |
| 2 | Add "verify theme token usage" to code review checklist for custom rendering | Bob (SM) | MEDIUM | No hardcoded color values in Epic 8 code |
| 3 | Document sync vs async processing pattern decision tree in story dev notes | Bob (SM) | LOW | Dev notes specify which pattern and why for each new tool |

### Carried Items Decision (FINAL — No More Carrying)

| # | Action | Decision | Owner | Notes |
|---|--------|----------|-------|-------|
| 4 | Add E2E Common Gotchas to CONTRIBUTING.md | **FORCE-EMBED in Epic 8 Story 1** | Bob (SM) to embed, Amelia (Dev) to implement | If not done in Epic 8, permanently drop |
| 5 | Audit remaining tools for type="number" silent-drop | **FORCE-EMBED in Epic 8 Story 1** | Bob (SM) to embed, Amelia (Dev) to implement | If not done in Epic 8, permanently drop |

### Technical Patterns (embed in Epic 8 story dev notes)

| # | Pattern | Apply When |
|---|---------|------------|
| 6 | WCAG attributes checklist: `role`, `aria-label`, `aria-live="polite"` on output regions | Every tool's output rendering |
| 7 | Theme tokens (`bg-success`, `bg-error`, `text-primary`) — NEVER hardcode color classes | Every tool, especially custom rendering |
| 8 | Sync pattern (try-catch, no sessionRef) for native APIs | Tools using native browser APIs (RegExp, crypto, etc.) |
| 9 | Async pattern (sessionRef + dynamic import) for external libraries | Tools requiring npm packages (diff, yaml, etc.) |
| 10 | Generator button pattern: explicit "Generate" click, not debounced live processing | UUID, Password, Hash tools |

### Team Agreements

**Continued:**

- Scope discipline — no creep without PO approval
- `import type` consistency
- Pure function testing strategy
- Documentation tasks done during the story that creates the drift
- Retro action items MUST be embedded in stories — standalone commitments are not allowed
- "Previous Story Intelligence" section required in every story after the first in an epic
- Separate display values from copy values — never pass formatted strings to CopyButton
- Validate parsed external data at runtime — no `as` casts at parse boundaries
- Whitespace-only input is a first-class edge case (where applicable)
- Test assertions must be specific (not `toBeTruthy` or bare `toThrow()`)
- Error messages always include example of valid input per architecture.md (where applicable)

**New:**

- WCAG accessibility attributes are a build-time checklist item, not a review catch
- Theme tokens MUST be used for all color values — hardcoded Tailwind colors are not acceptable
- Carried items get 3 epics maximum, then force-embed or permanently drop — no exceptions
- File List in story records must include ALL modified files, even formatting-only changes

## Epic 8 Preparation

### Critical (before Epic 8 starts)

- [ ] Embed carried items 4 & 5 into Epic 8 Story 1 (8-1-uuid-generator) — Owner: Bob
- [ ] Research MD5 library for Hash Generator (code-split compatible, ESM) — Owner: Charlie

### Parallel (can happen during early stories)

- [ ] Review `crypto.randomUUID()` and `crypto.getRandomValues()` browser support for UUID/Password tools — Owner: Elena
- [ ] Review `crypto.subtle.digest` API for SHA algorithms — Owner: Charlie
- [ ] Establish "Generator" tool domain directory in first story — Owner: Amelia

## Next Epic Preview: Epic 8 — Generator Tools

**Stories:** 3 (UUID Generator, Password Generator, Hash Generator)
**FRs covered:** FR22, FR23, FR24

**Dependencies on Epic 7:**

- None — Epic 8 depends on Epic 1 and 2 (both complete)

**Key Differences from Epic 7:**

- Processing trigger: explicit "Generate" button click (not debounced live input)
- UUID + Password are synchronous (native Web Crypto APIs: `crypto.randomUUID()`, `crypto.getRandomValues()`)
- Hash Generator has a hybrid approach: SHA algorithms via `crypto.subtle.digest` (async but native, no external library), MD5 requires a small external library (code-split, lazy-loaded)
- New category: Generator (similar to Text category creation in 7-1)
- Pre-generation on load: UUID and Password tools show a pre-generated value on dialog open

**No significant discoveries requiring Epic 8 plan changes.** Lessons from Epic 7 (accessibility checklist, theme token compliance, pattern selection) directly strengthen Epic 8 implementation.

## Readiness Assessment

- Testing & Quality: ✅ 467 tests passing, CI validates automatically
- Deployment: ✅ Static site, no deployment concerns
- Stakeholder Acceptance: ✅ Approved by Project Lead
- Technical Health: ✅ Stable — 1 LOW item left as-is (DiffChange type co-location, zero impact)
- Unresolved Blockers: ✅ None
- Epic 8 Readiness: ⏳ Pending MD5 library research and carried item embedding
