# Epic 9 Retrospective: CSS Visual Tools

**Date:** 2026-02-15
**Facilitator:** Bob (Scrum Master)
**Epic Status:** Complete — 1/1 stories done

## Team Participants

- Bob (Scrum Master) — Facilitator
- Alice (Product Owner) — Product perspective
- Charlie (Senior Dev) — Technical leadership
- Dana (QA Engineer) — Quality perspective
- Elena (Junior Dev) — Fresh eyes perspective
- csrteam (Project Lead) — Overall direction

## Epic Summary & Metrics

**Delivery:**

- Stories completed: 1/1 (100%)
- Velocity: Story completed in single session
- Scope changes: 0
- Production incidents: 0

**Quality:**

- Tests added: 14 new (505 → 519 total)
- Code review findings: 8 across 1 story (0H, 4M fixed, 4L deferred)
- Debug issues: 0 (cleanest implementation in project history)
- Technical debt introduced: 2 LOW items (missing aria-live="polite", hexToRgba no input validation)
- New dependencies: 0

**Stories Delivered:**

| Story | Title | Debug Issues | Review Fixes | Files Created | Files Modified |
|-------|-------|-------------|-------------|---------------|----------------|
| 9-1 | CSS Box Shadow Generator | 0 | 4 (4M) | 4 | 6 |

**FRs Delivered:**

- FR25: CSS box-shadow visual generator with live preview — complete

**Tools Added:**

- Box Shadow Generator (registry key: `box-shadow-generator`, chunk: 3.28 kB / 1.32 kB gzip)
- Registry now has 17 tools (up from 16)
- New tool category created: CSS

**Reusable Patterns Confirmed:**

- RangeInput (from 8-2) reused for all 5 sliders — proven across 3 epics now
- FlagToggle (from 8-2/7-2) reused for inset toggle
- Category bootstrap pattern (from 8-1) replicated exactly for CSS category

## Previous Retro Follow-Through (Epic 8)

| # | Action Item | Owner | Status | Notes |
|---|-------------|-------|--------|-------|
| 1 | Add async debounce safety pattern to story dev notes | Bob (SM) | ✅ N/A | Epic 9 had no async processing. Story explicitly documents "Do NOT add useDebounceCallback." Pattern was correctly evaluated as not needed. |
| 2 | Embed WCAG accessibility checklist as mandatory subtask in story template | Bob (SM) | ⏳ Partial | **THIRD EPIC carrying this.** M3 (a11y aria-label redundancy) caught and fixed in review. But L1 (missing aria-live="polite") was deferred. Not yet embedded as formal subtask. Per 3-epic rule, this is the FINAL carry. |

**Technical Patterns Applied:**

| # | Pattern | Status |
|---|---------|--------|
| 5 | Async debounce safety with refs | ✅ N/A (no async in Epic 9) |
| 6 | RangeInput for Box Shadow sliders | ✅ Applied — 5 sliders all use FieldForm type="range" |
| 7 | WCAG attributes checklist | ⏳ Partial — aria-pressed on inset toggle ✅, but missing aria-live on output ❌ |
| 8 | New category setup pattern | ✅ Applied — CSS category created following Generator/Text pattern exactly |

**Pattern confirmed for seventh consecutive epic:** Items not embedded in stories don't get done. The WCAG checklist has been carried 3 epics (7, 8, 9). Per the 3-epic rule established in Epic 8's retro, this MUST be embedded in the story template or permanently dropped.

## What Went Well

- **Seventh consecutive clean epic** — Zero scope creep, zero blockers, 100% delivery across Epics 3 through 9. This is a deeply stable, proven pattern.
- **Zero debug issues** — The cleanest implementation in project history. No debugging needed, no unexpected behavior, no gotchas. The synchronous processing pattern eliminates entire categories of bugs.
- **Zero HIGH code review findings** — Confirms Epic 8's insight: sync tools ship clean. All 3 sync tools (8-1, 8-2, 9-1) had 0 HIGH findings. The only 2 HIGH findings across Epics 7-9 were in the one async tool (8-3).
- **Zero new dependencies** — Pure string manipulation. No external libraries needed. Smallest bundle impact of any tool added.
- **RangeInput reuse proven across 3 epics** — Created in 8-2, retroactively applied to 8-1, now used for 5 sliders in 9-1. The "extract from implementation" approach produces better components than top-down design.
- **Category bootstrap is a repeatable template** — Generator (8-1) and CSS (9-1) followed identical steps: ToolCategory union → CATEGORY_ORDER → feature directory → barrel exports. Pattern is documented and mechanical.
- **Previous Story Intelligence eliminated guesswork** — Story 9-1's dev notes explicitly referenced patterns from 8-1 (inline layout), 8-2 (RangeInput, FlagToggle, FieldForm), and 8-3 (clearError). Zero pattern confusion.
- **Native color input (`<input type="color">`) adopted** — New input type for the project, handled with a clean two-part approach (color picker + alpha slider). Available for future tools.
- **Test growth continues strong** — 14 new tests (505 → 519). Tests cover CSS string generation, hex-to-rgba conversion, inset toggle, negative values, max values, and default config.
- **Smallest epic since Epic 5** — 1 story, completed efficiently. Single-story epics have 100% completion rate and zero overhead.

## What Didn't Go Well

- **WCAG accessibility checklist STILL not formally embedded (3rd epic)** — Despite explicit action items in Epics 7, 8, and now 9, the WCAG checklist remains an informal agreement rather than a mandatory subtask. L1 finding (missing `aria-live="polite"` on CSS output) is direct evidence. The mechanism of "agree in retro" is proven broken for this specific item.
- **4 MEDIUM code review findings (pattern consistency)** — While all were fixed, they reveal that the dev agent doesn't always follow established patterns:
  - M1: Created duplicate constant instead of importing from utils (DRY violation)
  - M2: Used `void clearError` instead of matching other tools' destructuring pattern
  - M3: Added redundant aria-label alongside label htmlFor
  - M4: Used overly permissive key type in handleNumberChange
- **4 LOW items deferred** — L1 (aria-live), L2 (hexToRgba validation), L3 (uppercase hex test), L4 (snapshot test). While individually minor, deferred LOW items accumulate as technical debt. L1 in particular is an accessibility gap.

## Key Insights

1. **Synchronous tools are the gold standard for quality** — Across Epics 7-9: sync tools (8-1, 8-2, 9-1) had 0 HIGH findings combined. The async tool (8-3) had 2 HIGH findings. When the computation can be synchronous, always prefer it. Debounce and async state management are where bugs live.
2. **Single-story epics have zero overhead** — Epic 9 (1 story) and Epic 5 (2 stories) are the two most efficient epics. No inter-story dependencies, no context switching, no velocity ramp. The tradeoff: less opportunity for cross-story learning within the epic.
3. **Pattern reuse compounds over time** — RangeInput (created in 8-2) is now used in 3 epics. FlagToggle (created in 7-2) is used in 3 tools. Previous Story Intelligence sections accelerate each new story by documenting what to reuse. The investment in documenting patterns pays dividends.
4. **Code review MEDIUM findings are consistently about pattern consistency** — Not bugs, not logic errors, not security issues. The pattern: dev agent builds a working tool but uses slightly different conventions. Code review normalizes. This is a healthy, expected dynamic.
5. **WCAG checklist must be formalized or permanently dropped** — Three epics of carrying this item proves the "agree and hope" mechanism is broken. The only options per our 3-epic rule: (a) embed as mandatory story subtask with specific checklist items, or (b) permanently drop. The team chose to embed.
6. **Category bootstrap is mechanical, not creative** — Following the Generator→CSS precedent, creating a new category is a series of predictable file changes. This can be documented as a copy-paste template. No design decisions needed.

## Action Items

### Process Improvements

| # | Action | Owner | Priority | Success Criteria |
|---|--------|-------|----------|-----------------|
| 1 | Embed WCAG accessibility checklist as MANDATORY subtask block in story creation workflow. Specific items: `aria-label` on inputs without visible labels, `aria-live="polite"` on dynamic output regions, `aria-pressed` on toggle buttons, `role` on semantic regions, keyboard navigation for all interactive elements. This is the FINAL carry — 3-epic rule triggered. | Bob (SM) | HIGH | Zero accessibility-related findings (any severity) in Epic 10 code reviews |
| 2 | Document category bootstrap as reusable template in story dev notes for future epics that introduce new categories | Bob (SM) | LOW | Template available when next category is needed |

### Technical Debt

| # | Item | Owner | Priority | Impact |
|---|------|-------|----------|--------|
| 3 | Add `aria-live="polite"` to Box Shadow Generator CSS output region (L1 from code review) | Dev | LOW | Screen readers not notified of output changes — accessibility gap |
| 4 | Add input validation to `hexToRgba` for invalid hex strings (L2 from code review) | Dev | LOW | No current failure path (color picker constrains input), but defensive programming |

### Team Agreements

**Continued:**

- Scope discipline — no creep without PO approval
- `import type` consistency
- Pure function testing strategy
- Documentation tasks done during the story that creates the drift
- Retro action items MUST be embedded in stories — standalone commitments are not allowed
- "Previous Story Intelligence" section required in every story after the first in an epic
- Separate display values from copy values — never pass formatted strings to CopyButton
- Validate parsed external data at runtime — no `as` casts at parse boundaries
- Test assertions must be specific (not `toBeTruthy` or bare `toThrow()`)
- WCAG accessibility attributes are a build-time checklist item, not a review catch
- Theme tokens MUST be used for all color values — hardcoded Tailwind colors are not acceptable
- File List in story records must include ALL modified files, even formatting-only changes
- Async debounce with multiple triggers requires `ref` guards beyond `sessionRef`
- Carried items get **3 epics maximum, then permanently drop** — no exceptions

**New:**

- Sync processing is the low-risk, high-quality pattern; prefer it when computation allows
- Category bootstrap is a repeatable mechanical template — follow Generator/CSS precedent
- Code review MEDIUM findings for pattern consistency are expected and healthy — the system works

## Epic 10 Preparation

### Research (before starting)

- [ ] Evaluate image crop selection libraries (react-image-crop, react-cropper, or custom Canvas) — Owner: Charlie
- [ ] Research Canvas API `toBlob()` quality parameter behavior across Chrome/Firefox/Safari — Owner: Elena

### Parallel (can happen during early development)

- [ ] Review existing ImageConvertor.tsx and ImageResizer.tsx for pattern alignment — Owner: Dev
- [ ] Verify ProgressBar component works with file processing pattern — Owner: Dev

## Next Epic Preview: Epic 10 — Advanced Image Tools

**Stories:** 2 (Image Compression, Image Cropping)
**FRs covered:** FR13, FR14

**Dependencies on Epic 9:** None — Epic 10 depends on Epic 1 and 2 (both complete)

**Key Characteristics:**

- File-processing tools — upload → process → download pattern (explicit action button, not live preview)
- Canvas API for both compression and cropping
- May need ProgressBar for operations exceeding 300ms
- Image Cropping likely needs a third-party library (draggable/resizable selection region)
- Touch-friendly mobile interaction required (crop handles ≥ 44x44px, no pinch-to-zoom conflict)
- Both tools add to existing Image category (already has Image Converter + Image Resizer)
- First epic with potential for slow processing since Epic 3

**No significant discoveries requiring Epic 10 plan changes.** Lessons from Epic 9 (sync tool quality, pattern reuse, category bootstrap) are incremental improvements, not plan-altering. Epic 10's file-processing pattern is well-established from Epic 3.

## Readiness Assessment

- Testing & Quality: ✅ 519 tests passing, CI validates automatically
- Deployment: ✅ Static site, no deployment concerns
- Stakeholder Acceptance: ✅ FR25 delivered per spec
- Technical Health: ✅ Stable — 2 LOW items are minor and non-blocking
- Unresolved Blockers: ✅ None
- New Dependencies: ✅ None (zero new dependencies this epic)
- Epic 10 Readiness: ✅ Zero blocking dependencies, research tasks are preparation-only
